From: Christopher Hoskin <mans0954@debian.org>
Date: Wed, 9 May 2018 20:21:39 +0100
Subject: Revert "Use csc instead of mcs"

This reverts commit da6d11e59afbac65111a4066574cdc1bdf619c6b.
---
 autogen.sh                |  2 +-
 build/Makefile.am         |  4 ++--
 build/build.rules.mk      |  4 ++--
 build/m4/shamrock/mono.m4 |  2 +-
 configure.ac              | 10 +++++-----
 5 files changed, 11 insertions(+), 11 deletions(-)

diff --git a/autogen.sh b/autogen.sh
index 41b78fe..b367ecb 100755
--- a/autogen.sh
+++ b/autogen.sh
@@ -94,4 +94,4 @@ run ./configure --enable-maintainer-mode $@
 # Stupid taglib-sharp snk garbage
 cp external/taglib-sharp/taglib-sharp.snk external/taglib-sharp/src
 
-rm -f bin/*.pdb
+rm -f bin/*.mdb
diff --git a/build/Makefile.am b/build/Makefile.am
index 6a7372c..4e9db7d 100644
--- a/build/Makefile.am
+++ b/build/Makefile.am
@@ -11,7 +11,7 @@ $(DLL_MAP_VERIFIER_ASSEMBLY): DllMapVerifier.cs
 	$(MCS) -out:$@ $<
 
 $(ADDIN_XML_STRING_EXTRACTOR_ASSEMBLY): AddinXmlStringExtractor.cs
-	$(MCS) -out:$@ $<
+	$(MCS) -r:System.Xml -out:$@ $<
 
 EXTRA_DIST = \
 	private-icon-theme-installer \
@@ -19,5 +19,5 @@ EXTRA_DIST = \
 	dll-map-makefile-verifier \
 	AddinXmlStringExtractor.cs
 
-CLEANFILES = *.exe *.pdb
+CLEANFILES = *.exe *.mdb
 MAINTAINERCLEANFILES = Makefile.in
diff --git a/build/build.rules.mk b/build/build.rules.mk
index 99d0fe9..68a5152 100644
--- a/build/build.rules.mk
+++ b/build/build.rules.mk
@@ -43,7 +43,7 @@ DEP_LINK = $(shell echo "$(LINK)" | $(UNIQUE_FILTER_PIPE) | sed s,-r:,,g | grep
 
 OUTPUT_FILES = \
 	$(ASSEMBLY_FILE) \
-	$(ASSEMBLY_FILE).pdb
+	$(ASSEMBLY_FILE).mdb
 
 moduledir = $(INSTALL_DIR_RESOLVED)
 module_SCRIPTS = $(OUTPUT_FILES)
@@ -65,7 +65,7 @@ run:
 build-debug:
 	@echo $(DEP_LINK)
 
-$(ASSEMBLY_FILE).pdb: $(ASSEMBLY_FILE)
+$(ASSEMBLY_FILE).mdb: $(ASSEMBLY_FILE)
 
 $(ASSEMBLY_FILE): $(SOURCES_BUILD) $(RESOURCES_EXPANDED) $(DEP_LINK)
 	@mkdir -p $(top_builddir)/bin
diff --git a/build/m4/shamrock/mono.m4 b/build/m4/shamrock/mono.m4
index b361a07..2ab574f 100644
--- a/build/m4/shamrock/mono.m4
+++ b/build/m4/shamrock/mono.m4
@@ -1,6 +1,6 @@
 AC_DEFUN([SHAMROCK_FIND_MONO_4_0_COMPILER],
 [
-	SHAMROCK_FIND_PROGRAM_OR_BAIL(MCS, csc)
+	SHAMROCK_FIND_PROGRAM_OR_BAIL(MCS, mcs)
 ])
 
 AC_DEFUN([SHAMROCK_FIND_MONO_RUNTIME],
diff --git a/configure.ac b/configure.ac
index 30abaa3..0dc8d60 100644
--- a/configure.ac
+++ b/configure.ac
@@ -62,8 +62,8 @@ SHAMROCK_EXPAND_DATADIR
 dnl User help
 SHAMROCK_CHECK_GNOME_DOC_UTILS(0.17.3)
 
-dnl Mono and csc
-SHAMROCK_CHECK_MONO_MODULE(5.8.0)
+dnl Mono and mcs
+SHAMROCK_CHECK_MONO_MODULE(3.2.8)
 SHAMROCK_FIND_MONO_4_0_COMPILER
 SHAMROCK_FIND_MONO_RUNTIME
 SHAMROCK_CHECK_MONO_4_5_GAC_ASSEMBLIES([
@@ -89,10 +89,10 @@ FSPOT_ENABLE_TESTS
 
 
 # ---------------------------------- <Old build stuff>
-dnl --- Check for mono and csc
+dnl --- Check for mono and mcs
 
 AC_PATH_PROG(MONO, mono)
-AC_PATH_PROG(MCS, csc)
+AC_PATH_PROG(MCS, mcs)
 
 CS="C#"
 if test ! -x "$MCS"; then
@@ -252,7 +252,7 @@ AM_CONDITIONAL(ENABLE_RELEASE, test "x$enable_release" = "xyes")
 ENABLE_RELEASE=$enable_release
 AC_SUBST(ENABLE_RELEASE)
 if test "x$enable_release" = "xyes"; then
-	MCS_FLAGS="-define:RELEASE"
+	MCS_FLAGS="-define:RELEASE -sdk:4"
 	PROFILE_NAME="Release"
 else
 	PROFILE_NAME="Debug"
